<!--
/// ==========================================
/// File Name:    profile.html
/// Created By:   Wyatt Bechtle
/// Created On:   2025-10-04
/// Purpose:      Provides a user profile page for the web application.
///  Updated By: Jamie Coker 10/29/2025
///  Updated Notes: update head block for styling and added Footer
                    adjusted nav bar for easier styling
/// Updated By: Jamie Coker 11/06/2025
///  Updated Notes: Update Notes:
   - Switched navbar links & Sign Out to shared .btn-fantasy style
   - Replaced Bootstrap button on Edit Profile with .btn-fantasy
   - Kept nav structure for responsive layout; no wrapper glow on Sign Out
/// ==========================================
-->
<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/" data-bs-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User Profile</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Loreweave custom fantasy theme -->
    <link rel="stylesheet" th:href="@{/css/styles.css}">


    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
</head>

<!-- Page transition overlay -->
<div id="page-transition"></div>

<body class="profile-body">


<div th:replace="~{fragments/navbar :: navbar}"></div>


<main class="profile-container">
      <section th:if="${param.updated}" 
               class="alert alert-success">Profile updated successfully.</section>
      <!-- User Profile Section -->
      <section class="bg-body-tertiary border rounded-3 p-3 p-md-4 mb-4">
        <h1 class="h4 mb-3">
          <i class="bi bi-person-circle me-2"></i>Your Profile
        </h1>
        <p class="mb-1">
          <strong>Name:</strong>
          <span th:text="${#strings.defaultString(user.firstName,'')}"></span>
          <span th:text="${#strings.defaultString(user.lastName,'')}"></span>
        </p>
        <p class="mb-1">
          <strong>Username:</strong> 
          <span th:text="${user.username}">username</span>
        </p>
        <p class="mb-3">
          <strong>Email:</strong> 
          <span th:text="${user.email}">email@example.com</span>
        </p>
          <a class="btn-fantasy" th:href="@{/profile/edit}">

          <i class="bi bi-pencil-square me-2"></i>Edit Profile
        </a>
      </section>
      <!-- Character Section -->
      <section class="bg-body-tertiary border rounded-3 p-3 p-md-4 mb-4">
        <h2 class="h5 mb-3">
          <i class="bi bi-person-bounding-box me-2"></i>Your Character
        </h2>
        <div th:if="${character != null}">
          <p class="mb-1">
            <strong>Name:</strong> 
            <span th:text="${character.name}">Name</span>
          </p>
          <p class="mb-1">
            <strong>Lore Points:</strong> 
            <span th:text="${character.lorePoints}">0</span>
          </p>
          <p class="mb-0">
            <strong>Description:</strong>
          </p>
          <p th:text="${character.description}">Character description…</p>
        </div>
        <div th:if="${character == null}" class="alert alert-secondary mb-0">
          You don’t have a character yet. Create one from the <a href="/characters" class="alert-link">Characters</a> page.
        </div>
      </section>
      <!-- Stories Sections -->
      <section class="bg-body-tertiary border rounded-3 p-3 p-md-4 mb-4">
        <h2 class="h6 mb-3">
          <i class="bi bi-journal-text me-2"></i>Stories You Created
        </h2>
        <p th:if="${#lists.isEmpty(createdStories)}" 
           class="text-secondary mb-0">No stories created yet.</p>
        <ul class="list-group list-group-flush" 
            th:if="${!#lists.isEmpty(createdStories)}">
          <li class="list-group-item bg-body-tertiary" 
              th:each="s : ${createdStories}">
            <span th:text="${s.title}">Story title</span>
            <a th:href="@{'/story/' + ${s.id}}"
               class="btn btn-sm btn-outline-light float-end">View</a>
          </li>
        </ul>
      </section>
      <!-- Contributed Stories Section -->
      <section class="bg-body-tertiary border rounded-3 p-3 p-md-4">
        <h2 class="h6 mb-3">
          <i class="bi bi-pen me-2"></i>Stories You Contributed To
        </h2>
        <p th:if="${#lists.isEmpty(contributedStories)}" 
           class="text-secondary mb-0">No contributions yet.</p>
        <ul class="list-group list-group-flush" 
            th:if="${!#lists.isEmpty(contributedStories)}">
          <li class="list-group-item bg-body-tertiary" 
              th:each="s : ${contributedStories}">
            <span th:text="${s.title}">Story title</span>
            <a th:href="@{'/story/' + ${s.id}}"
               class="btn btn-sm btn-outline-light float-end">View</a>
          </li>
        </ul>
      </section>
    </main>
    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Loreweave | A world where every player becomes an author.</p>
    </footer>
<script>
    // Fade in when page loads
    document.body.classList.add('fade-in');

    // Fade out when following internal links
    document.addEventListener('click', (e) => {
      const link = e.target.closest('a');
      if (link && link.href && link.target !== '_blank' && link.href.startsWith(window.location.origin)) {
        e.preventDefault();
        document.body.classList.add('fade-out');
        setTimeout(() => {
          window.location.href = link.href;
        }, 2000); // matches slower 4s fade duration
      }
    });
</script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"></script>
  </body>
</html>