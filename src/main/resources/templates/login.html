<!--
    File Name: login.html
    Created By: Wyatt Bechtle
    Created On: 9/15/2025
    Purpose: To provide login capabilities to the loreweave application

    Updated By: Jamie Coker on 9/21/2025
    Update Notes: Added Thymeleaf th:action + method="post" for Spring Security integration.

    Updated By: Chris Ennis on 9/24/2025
    Update Notes: Corrected registration link to point to /auth/register.

    Updated By: Wyatt Bechtle on 9/27/2025
    Update Notes: Updated the styling and interaction of the form
                  Added CSRF protection
                  Added checkbox to show password
                  Created JS to toggle PW visibility
                  Integrated remember-me with Spring Security

    Updated By: Wyatt Bechtle on 10/04/2025
    Update Notes: Changed loginBSF -> login
    Updated By: Jamie Coker on 11/02/2025
    Update Notes: Added Loreweave header with navigation to home page.
                  Added footer and applied fantasy-themed styling.

-->
<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>login</title>
      <link rel="stylesheet" th:href="@{/css/styles.css}">
    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
          rel="stylesheet">

  <head>
      <!-- Page transition overlay -->
      <div id="page-transition"></div>

  <body class="login-body">

  <!-- Header -->
    <header class="main-header login-header">
      <h1 class="hero-title login-title">
          <a th:href="@{/}" class="header-link">Loreweave</a>
      </h1>
  </header>


  <!-- Login Container -->
  <main class="login-wrapper">
      <div class="login-box">
          <h2 class="login-heading"><i class="bi bi-door-open me-2"></i>Sign In</h2>

          <form th:action="@{/login}" method="post" class="login-form">
              <input type="hidden"
                     th:if="${_csrf != null}"
                     th:name="${_csrf.parameterName}"
                     th:value="${_csrf.token}" />

              <!-- Username -->
              <label for="username">Username</label>
              <input type="text" id="username" name="username" placeholder="Username" required>

              <!-- Password -->
              <label for="password">Password</label>
              <input type="password" id="password" name="password" placeholder="Password" required>

              <div class="form-options">
                  <label><input type="checkbox" id="showPW"> Show password</label>
                  <label><input type="checkbox" name="remember-me"> Remember me</label>
              </div>

              <div th:if="${param.error}" class="alert alert-danger" role="alert">
                  Invalid Username or Password
              </div>

              <button type="submit" class="btn-login">Start Weaving</button>

              <p class="signup-text">
                  New to Loreweave? <a href="api/auth/register">Create an account</a>
              </p>

          </form>
      </div>
  </main>
  </head>
        <!-- Footer -->
        <footer>
            <p>&copy; 2025 Loreweave | A world where every player becomes an author.</p>
        </footer>
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
                crossorigin="anonymous">
        </script>
        <!-- Toggles password visibility -->
        <script>
          const password = document.getElementById('password');
          const checkbox = document.getElementById('showPW');
          checkbox?.addEventListener('change', () => {password.type = checkbox.checked ? 'text' : 'password';});
        </script>
      <script>
          // Fade in when page loads
          document.body.classList.add('fade-in');

          // Fade out when following internal links
          document.addEventListener('click', (e) => {
            const link = e.target.closest('a');
            if (link && link.href && link.target !== '_blank' && link.href.startsWith(window.location.origin)) {
              e.preventDefault();
              document.body.classList.add('fade-out');
              setTimeout(() => {
                window.location.href = link.href;
              }, 2000); // matches slower 4s fade duration
            }
          });
      </script>


      </body>
    </html>