<!--
  ==========================================
  File Name:    verify-email.html
  Created By:   Jamie Coker
  Created On:   2025-10-19
  Purpose:      Page for user to enter OTP for email verification.
  Updated By:   Jamie Coker on 10/27/2025
  Update Notes:
      - Moved alert messages above form for visibility.
      - Added Bootstrap icons for success/error.
      - Matched register.html feedback styling.
  ==========================================
-->
<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/" data-bs-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Email Verification</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Loreweave custom theme -->
    <link rel="stylesheet" th:href="@{/css/styles.css}">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
</head>
<!-- Page transition overlay -->
<div id="page-transition"></div>

<body class="verify-body">

<main>
    <section class="verify-container">
        <h1><i class="bi bi-envelope-check me-2"></i>Email Verification</h1>
        <p>Enter the 6-digit code sent to <strong th:text="${email}">your email</strong>.</p>

        <div th:if="${error}" class="alert alert-danger text-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <span th:text="${error}"></span>
        </div>
        <div th:if="${message}" class="alert alert-success text-center" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i>
            <span th:text="${message}"></span>
        </div>

        <form th:action="@{/verify-email}" method="post">
            <input type="hidden" name="email" th:value="${email}" />

            <label for="otp" class="form-label">Verification Code</label>
            <input type="text" id="otp" name="otp" maxlength="6" pattern="[0-9]{6}" required placeholder="123456">

            <button type="submit"><i class="bi bi-check2-circle me-2"></i>Verify</button>

            <p class="mt-3">
                Didnâ€™t get a code? <a href="/auth/register">Resend</a><br>
                Already verified? <a href="/auth/login">Login</a>
            </p>
        </form>
    </section>
</main>

<footer>
    <p>&copy; 2025 Loreweave | A world where every player becomes an author.</p>
</footer>
<script>
    // Fade in when page loads
    document.body.classList.add('fade-in');

    // Fade out when following internal links
    document.addEventListener('click', (e) => {
      const link = e.target.closest('a');
      if (link && link.href && link.target !== '_blank' && link.href.startsWith(window.location.origin)) {
        e.preventDefault();
        document.body.classList.add('fade-out');
        setTimeout(() => {
          window.location.href = link.href;
        }, 2000); // matches slower 4s fade duration
      }
    });
</script>
</body>

</html>
